(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{0:function(t,e,n){t.exports=n("2v48")},"2mhZ":function(t,e,n){"use strict";n.d(e,"a",(function(){return x})),n.d(e,"b",(function(){return S})),n.d(e,"c",(function(){return m})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return b})),n.d(e,"f",(function(){return E})),n.d(e,"g",(function(){return j})),n.d(e,"h",(function(){return O})),n.d(e,"i",(function(){return w})),n.d(e,"j",(function(){return I})),n.d(e,"k",(function(){return P})),n.d(e,"l",(function(){return _})),n.d(e,"m",(function(){return T})),n.d(e,"n",(function(){return B})),n.d(e,"o",(function(){return y})),n.d(e,"p",(function(){return A})),n.d(e,"q",(function(){return v})),n.d(e,"r",(function(){return $})),n.d(e,"s",(function(){return z})),n.d(e,"t",(function(){return M})),n.d(e,"u",(function(){return D}));var r=n("UA48"),o=n("CIZ5"),a=n("8Y7J"),i=n("e1JD"),s=n("Mrqg"),c=n("2Vo4"),u=n("cp0P"),l=n("7+OI"),d=n("lJxs"),p=n("UXun");function f(t){return t.NGXS_OPTIONS_META||{name:""}}class g extends Error{constructor(t){super(`Child states can only be added to an object. Cannot convert ${t&&t.constructor?t.constructor.name:t} to PlainObject`)}}function b(t){var e;const n=f(t),o=null!==(e=n.children)&&void 0!==e?e:[],a=void 0===n.defaults?{}:n.defaults,i=Object(r.a)(a);if(o.length){if(Object(r.d)(i))return function(t,e){return e.reduce((t,e)=>{const n=f(e);if(!n.name)throw new Error("State name not provided in class");return t[n.name.toString()]=b(e),t},null!=t?t:{})}(i,o);throw new g(i)}return i}function h(t){const{statePath:e,argumentsNames:n,methodName:r,argumentRegistry:o}=t;let a="";for(let i=0;i<n.length;i++)(null==o?void 0:o.getArgumentNameByIndex(i))?a+=null==o?void 0:o.getArgumentNameByIndex(i):(null==o?void 0:o.getPayloadTypeByIndex(i))?a+=null==o?void 0:o.getPayloadTypeByIndex(i):a+="$arg"+i,i!==n.length-1&&(a+=", ");return`@${e.replace(/\./g,"/")}.${r}(${a})`}function y(t){if(!t.hasOwnProperty(o.e)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(t,o.e,{value:e})}return function(t){return t[o.e]}(t)}function v(t){return t[o.c]}let m=(()=>{class t{constructor(t){this.sequence$=new c.a(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return t.\u0275fac=function(e){return new(e||t)(a.Wb(i.g,8))},t.\u0275prov=a.Ib({token:t,factory:t.\u0275fac}),t})(),S=(()=>{class t{constructor(e,n,r){t.store=e.get(i.g),t.ngZone=e.get(a.B),t.factory=n,t.context=r,t.computed=e.get(m)}}return t.\u0275fac=function(e){return new(e||t)(a.Wb(a.t),a.Wb(s.d),a.Wb(s.c))},t.\u0275prov=a.Ib({token:t,factory:t.\u0275fac}),t.store=null,t.computed=null,t.context=null,t.factory=null,t.ngZone=null,t})(),x=(()=>{class t{constructor(){t.statesCachedMeta.clear()}static createStateContext(t){return S.context.createStateContext(t)}static ensureMappedState(e){if(!S.factory||!e)throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(e.name?t.statesCachedMeta.get(e.name):null)||t.ensureMeta(e)}static getRepositoryByInstance(e){const n=v(t.getStateClassByInstance(e))||null;if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return n}static getStateClassByInstance(t){return(t||{}).constructor}static clearMetaByInstance(e){const n=t.getRepositoryByInstance(e);n.stateMeta.actions={},n.operations={}}static createPayload(t,e){const n={},r=Array.from(t);for(let o=0;o<r.length;o++){const t=null==e?void 0:e.getPayloadTypeByIndex(o);t&&(n[t]=r[o])}return Object.keys(n).length>0?n:null}static createAction(e,n,r){const o=t.createPayload(n,r);var a;return new(a=e.type,class{constructor(t){t&&Object.keys(t).forEach(e=>{this[e]=t[e]})}static get type(){return a}})(o)}static ensureMeta(e){var n;const r=e.name?null===(n=S.factory.states)||void 0===n?void 0:n.find(t=>t.name===e.name):null;return r&&e.name&&t.statesCachedMeta.set(e.name,r),r}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=a.Ib({token:t,factory:t.\u0275fac}),t.statesCachedMeta=new Map,t})();function O(t){return{enumerable:!0,configurable:!0,get(){const e=v(t),n=x.ensureMappedState(e.stateMeta);return x.createStateContext(n)}}}function w(t,e){(function(t){var e;const n=null!==(e=v(t))&&void 0!==e?e:null;return(!n||(null==n?void 0:n.stateClass)!==t)&&function(t){Object.defineProperty(t,o.c,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:t}})}(t),v(t)}(t)).stateMeta=e}function I(t){const e=v(t),n=e.stateMeta&&e.stateMeta.name||null;if(n){const e=`__${n}__selector`;Object.defineProperties(t.prototype,{[e]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(this[e])return this[e];if(!S.store)throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[e]=S.store.select(t).pipe(Object(d.a)(t=>Object(a.Y)()?Object(r.b)(t):t),Object(p.a)({refCount:!0,bufferSize:1})),this[e]}}})}}function M(t,e){if(t.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}function E(){if(!S.ngZone)throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!")}function j(t,e){return Object(u.a)([t,e]).pipe(Object(d.a)(t=>t.pop()))}class k extends Error{constructor(t,e){super(`An argument with the name '${t}' already exists in the method '${e}'`)}}class N{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(t){var e;return null!==(e=this.payloadMap.get(t))&&void 0!==e?e:null}getArgumentNameByIndex(t){var e;return null!==(e=this.argumentMap.get(t))&&void 0!==e?e:null}createPayloadType(t,e,n){this.checkDuplicateName(t,e),this.payloadMap.set(n,t),this.payloadMap.set(t,t)}createArgumentName(t,e,n){this.checkDuplicateName(t,e),this.argumentMap.set(n,t),this.argumentMap.set(t,t)}checkDuplicateName(t,e){if(this.argumentMap.has(t)||this.payloadMap.has(t))throw new k(t,e)}}function A(t){return t[o.a]}function T(t,e){const n=t[e];return A(n)||Object.defineProperties(n,{[o.a]:{enumerable:!0,configurable:!0,value:new N}}),A(n)}function D(t,e){if(!Object(r.c)(t,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}function _(t){if(!t)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},t),{getState:()=>Object(a.Y)()?Object(r.b)(t.getState()):t.getState(),setState(e){t.setState(e)},patchState(e){t.patchState(e)}})}function C(){return`__${o.b}__`}function R(t){var e;return null!==(e=t[C()])&&void 0!==e?e:null}function P(t){return R(t)||Object.defineProperties(t,{[C()]:{enumerable:!0,configurable:!0,value:new WeakMap}}),R(t)}function B(t){return Object(a.Y)()?Object(r.b)(t):t}function $(){var t,e;return null!==(e=null===(t=null==S?void 0:S.computed)||void 0===t?void 0:t.sequenceValue)&&void 0!==e?e:0}function z(t){let e=!1;return Object(l.a)(t)&&(e=!0),e}},"2v48":function(t,e,n){"use strict";n.r(e);var r=n("8Y7J"),o=n("s7LF"),a=n("cUpR"),i=n("omvX"),s=n("2mhZ");let c=(()=>{class t{constructor(t,e){this.accessor=t,this.injector=e}static forRoot(e=[]){return{ngModule:t,providers:[s.a,s.b,s.c,...e]}}}return t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({factory:function(e){return new(e||t)(r.Wb(s.a,2),r.Wb(s.b,2))}}),t})();var u=n("BbUs"),l=n("ZArt"),d=n("e1JD"),p=n("iInd");let f=(()=>{class t{}return t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({factory:function(e){return new(e||t)},imports:[[p.b.forRoot([{path:"",redirectTo:"count",pathMatch:"full"},{path:"count",loadChildren:()=>Promise.all([n.e(0),n.e(11)]).then(n.bind(null,"iBbY")).then(t=>t.CountModule)},{path:"todo",loadChildren:()=>Promise.all([n.e(0),n.e(2),n.e(13)]).then(n.bind(null,"BX/J")).then(t=>t.TodoModule)},{path:"person",loadChildren:()=>Promise.all([n.e(0),n.e(3),n.e(12)]).then(n.bind(null,"rAEy")).then(t=>t.PersonModule)},{path:"amount",loadChildren:()=>Promise.all([n.e(0),n.e(9)]).then(n.bind(null,"h86J")).then(t=>t.AmountModule)},{path:"article",loadChildren:()=>Promise.all([n.e(0),n.e(2),n.e(3),n.e(10)]).then(n.bind(null,"BVaH")).then(t=>t.ArticleModule)}],{useHash:!0})],p.b]}),t})();var g=n("SVse");const b=function(){return["count"]},h=function(){return["todo"]},y=function(){return["person"]},v=function(){return["amount"]},m=function(){return["article"]};let S=(()=>{class t{constructor(t){this.store=t,this.snapshot=this.store.select(t=>t)}ngOnInit(){console.log("[isDevMode]",Object(r.Y)())}}return t.\u0275fac=function(e){return new(e||t)(r.Mb(d.g))},t.\u0275cmp=r.Gb({type:t,selectors:[["app-root"]],decls:72,vars:15,consts:[[1,"panel"],["src","https://habrastorage.org/webt/k7/ih/pc/k7ihpcg6w-jz-rzksmiyuip5_so.png",1,"logo"],[1,"panel-content"],[1,"menu"],[1,"menu-top"],["href","https://github.com/ngxs-labs/data/tree/master/docs","target","_blank",1,"link"],["href","https://stackblitz.io/github/ngxs-labs/data","target","_blank",1,"link"],[1,"ng-icon"],["src","https://cdn.worldvectorlogo.com/logos/angular-icon-1.svg",1,"img"],[1,"link",3,"routerLink"],[1,"container"],[1,"content"]],template:function(t,e){1&t&&(r.Sb(0,"div",0),r.tc(1,"\n    "),r.Nb(2,"img",1),r.tc(3,"\n\n    "),r.Sb(4,"div",2),r.tc(5,"\n        "),r.Sb(6,"h2"),r.tc(7,"Store:"),r.Rb(),r.tc(8,"\n        "),r.Sb(9,"pre"),r.tc(10),r.cc(11,"json"),r.cc(12,"async"),r.Rb(),r.tc(13,"\n    "),r.Rb(),r.tc(14,"\n"),r.Rb(),r.tc(15,"\n\n"),r.Sb(16,"div",3),r.tc(17,"\n    "),r.Sb(18,"div",4),r.tc(19,"\n        "),r.Sb(20,"span"),r.tc(21,"\n            \u{1f9fe}\n            "),r.Sb(22,"a",5),r.tc(23,"\n                Official documentation\n            "),r.Rb(),r.tc(24,"\n        "),r.Rb(),r.tc(25,"\n        "),r.Sb(26,"span"),r.tc(27,"\n            \u{1f680} "),r.Sb(28,"a",6),r.tc(29,"Stackblitz"),r.Rb(),r.tc(30,"\n        "),r.Rb(),r.tc(31,"\n        "),r.Sb(32,"span",7),r.tc(33,"\n            "),r.Nb(34,"img",8),r.tc(35,"\n            Angular 8+, NGXS 3.6.2+\n        "),r.Rb(),r.tc(36,"\n    "),r.Rb(),r.tc(37,"\n\n    "),r.Sb(38,"span"),r.tc(39,"\u{1f3c0} "),r.Sb(40,"a",9),r.tc(41,"CountState"),r.Rb(),r.Rb(),r.tc(42,"\n    "),r.Sb(43,"span"),r.tc(44,"\u{1f9ed} "),r.Sb(45,"a",9),r.tc(46,"TodoState"),r.Rb(),r.Rb(),r.tc(47,"\n    "),r.Sb(48,"span"),r.tc(49,"\u{1f60b} "),r.Sb(50,"a",9),r.tc(51,"PersonState"),r.Rb(),r.Rb(),r.tc(52,"\n    "),r.Sb(53,"span"),r.tc(54,"\u{1f4b0} "),r.Sb(55,"a",9),r.tc(56,"AmountState"),r.Rb(),r.Rb(),r.tc(57,"\n    "),r.Sb(58,"span"),r.tc(59,"\u{1f4cb} "),r.Sb(60,"a",9),r.tc(61,"ArticleEntitiesState"),r.Rb(),r.Rb(),r.tc(62,"\n"),r.Rb(),r.tc(63,"\n\n"),r.Nb(64,"br"),r.tc(65,"\n\n"),r.Sb(66,"div",10),r.tc(67,"\n    "),r.Sb(68,"div",11),r.Nb(69,"router-outlet"),r.Rb(),r.tc(70,"\n"),r.Rb(),r.tc(71,"\n")),2&t&&(r.Cb(10),r.uc(r.dc(11,6,r.dc(12,8,e.snapshot))),r.Cb(30),r.gc("routerLink",r.hc(10,b)),r.Cb(5),r.gc("routerLink",r.hc(11,h)),r.Cb(5),r.gc("routerLink",r.hc(12,y)),r.Cb(5),r.gc("routerLink",r.hc(13,v)),r.Cb(5),r.gc("routerLink",r.hc(14,m)))},directives:[p.a,p.c],pipes:[g.f,g.b],encapsulation:2,changeDetection:0}),t})(),x=(()=>{class t{}return t.\u0275mod=r.Kb({type:t,bootstrap:[S]}),t.\u0275inj=r.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[a.a,o.e,f,i.b,o.k,d.c.forRoot([],{developmentMode:!1,executionStrategy:d.d}),l.a.forRoot(),c.forRoot([u.b,u.a])]]}),t})();Object(r.U)(),a.c().bootstrapModule(x).catch(t=>console.error(t))},"BS/u":function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="BS/u"},BbUs:function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return _})),n.d(e,"c",(function(){return P})),n.d(e,"d",(function(){return R}));var r=n("8Y7J"),o=n("e1JD"),a=n("WbJO"),i=n("SVse"),s=n("CIZ5"),c=n("l5mm"),u=n("xgIS"),l=n("vkgz"),d=n("2mhZ"),p=n("UA48");const f=new r.s("NGXS_DATA_STORAGE_CONTAINER_TOKEN");class g{constructor(){this.providers=new Set,this.keys=new Map}getProvidedKeys(){return Array.from(this.keys.keys())}}const b={provide:f,useFactory:function(){return new g}},h=new r.s("NGXS_DATA_STORAGE_DECODE_TYPE_TOKEN");function y(t){return-1!==t.ttl&&!isNaN(t.ttl)&&t.ttl>0}function v(t){return Date.now()>=t.getTime()}function m(t){return`${t.prefixKey}${t.path}`}function S(t,e){var n,r,o;const{provider:a,expiry:i}=e,s={key:t,expiry:i.toISOString(),timestamp:new Date(Date.now()).toISOString()},c=a.stateInstance;null===(n=null==c?void 0:c.expired$)||void 0===n||n.next(s),(null==c?void 0:c.ngxsDataAfterExpired)&&(d.b.ngZone?null===(r=d.b.ngZone)||void 0===r||r.run(()=>{var t;return null===(t=null==c?void 0:c.ngxsDataAfterExpired)||void 0===t?void 0:t.call(c,s,a)}):null===(o=null==c?void 0:c.ngxsDataAfterExpired)||void 0===o||o.call(c,s,a))}class x extends Error{constructor(t){super(`${t}. \nIncorrect structure for deserialization!!! Your structure should be like this: \n${JSON.stringify({lastChanged:"2020-01-01T12:00:00.000Z",data:"{}",version:1},null,4)}`)}}function O(t){try{return JSON.parse(t)}catch(e){throw new x(e.message)}}function w(t){var e,n;const{provider:r,map:o}=t;null===(e=o.get(r))||void 0===e||e.subscription.unsubscribe();const a=()=>{const e=new Date(Date.now()).toISOString(),n=Object(c.a)(r.ttlDelay).subscribe(()=>function(t,e,n){const{provider:r,expiry:o,map:a,engine:i}=e,s=m(r),c=i.getItem(s);if(c){if(v(o)){const o=new Date(Date.now()).toISOString();!function(t,e,n){const{provider:r,engine:o}=n;switch(r.ttlExpiredStrategy){case 0:o.removeItem(t);break;case 1:const n=O(e);n.data=null,o.setItem(t,JSON.stringify(n))}}(s,c,e),S(s,e),n.unsubscribe(),a.set(r,{subscription:n,startListen:t,endListen:o})}}else n.unsubscribe()}(e,t,n));o.set(r,{subscription:n,startListen:e,endListen:null})};d.b.ngZone?null===(n=d.b.ngZone)||void 0===n||n.runOutsideAngular(()=>a()):a()}class I extends Error{constructor(){super("missing key 'data' or it's value not serializable.")}}class M extends Error{constructor(t){super(`lastChanged key not found in object ${t}.`)}}class E extends Error{constructor(t){super(`It's not possible to determine version (${t}), since it must be a integer type and must equal or more than 1.`)}}function j(t,e){const n=Object(a.d)(t)?t:null;return"base64"===e.decode?btoa(JSON.stringify(n)):n}class k extends Error{constructor(t){super(`Not found storage engine from \`existingEngine\` or not found instance after injecting by \`useClass\`. \nMetadata { key: '${t}' }`)}}class N extends Error{constructor(){super("StorageEngine instance should be implemented by DataStorageEngine interface")}}function A(t,e){const n=t.existingEngine||e.get(t.useClass,null);if(!n)throw new k(m(t));if(!("getItem"in n))throw new N;return n}function T(t,e){console.warn(`Error occurred while serializing value from metadata { key: '${t}' }. \nError serialize: ${e}`)}let D=(()=>{class t{constructor(e,n){this._platformId=e,t.injector=n,this.listenWindowEvents()}get store(){return t.injector.get(o.g,null)}get size(){return this.providers.size}get ttlListeners(){return t.ttlListeners}get container(){return t.injector.get(f)}get providers(){return this.container.providers}get keys(){return this.container.keys}get entries(){return this.providers.entries()}get skipStorageInterceptions(){return 0===this.size||Object(i.r)(this._platformId)}static checkIsStorageEvent(t,e,n){var r;const{action:o,provider:a,key:i,value:c}=t;if(e.rehydrateIn&&function(t){return t.type===s.d}(o)){const t=a.stateInstance;(null==t?void 0:t.ngxsDataAfterStorageEvent)&&(null===(r=null==t?void 0:t.ngxsDataAfterStorageEvent)||void 0===r||r.call(t,{key:i,value:c,data:n,provider:a}))}}static checkExpiredInit(t){const{info:e,rehydrateInfo:n,options:r,map:o}=t,{provider:a,engine:i}=r;n.rehydrateIn&&e.expiry&&w({provider:a,expiry:e.expiry,map:o,engine:i})}handle(t,e,n){if(this.skipStorageInterceptions)return n(t,e);const r=function(t){const e=Object(o.i)(t);return e(o.a)||e(o.h)}(e);return n(t=this.pullStateFromStorage(t,{action:e,init:r}),e).pipe(Object(l.a)(n=>this.pushStateToStorage(t,n,{action:e,init:r})))}serialize(e,n){const r={version:n.version,lastChanged:(new Date).toISOString(),data:j(e,n)};if(y(n)){const e=A(n,t.injector),o=new Date(Date.now()+parseInt(n.ttl));w({provider:n,expiry:o,map:this.ttlListeners,engine:e}),r.expiry=o.toISOString()}return JSON.stringify(r)}deserialize(t,e,n){return function(t,e,n){if(Object(p.d)(t)){if(function(t){return!("lastChanged"in t)||!t.lastChanged}(t))throw new M(e);if(function(t){const e=parseFloat(t.version);return isNaN(e)||e<1||parseInt(t.version)!==e}(t))throw new E(t.version);if(function(t){return!("data"in t)}(t))throw new I;return"base64"===n.decode?JSON.parse(atob(t.data)):t.data}throw new x(`"${e}" not an object`)}(t,e,n)}destroyOldTasks(){var e;null===(e=t.eventsSubscriptions)||void 0===e||e.unsubscribe(),t.ttlListeners=new WeakMap}pushStateToStorage(e,n,r){for(const[i]of this.entries){const s=Object(o.k)(e,i.path),c=Object(o.k)(n,i.path),u=i.fireInit&&r.init;if(s!==c||u){const e=A(i,t.injector),n=m(i);try{const t=this.serialize(c,i);e.setItem(n,t),this.keys.set(n)}catch(a){T(n,a.message)}}}}pullStateFromStorage(t,{action:e,init:n}){if(this.canBeSyncStoreWithStorage(e,n))for(const[r]of this.entries)t=this.deserializeByProvider(t,e,r);return t}canBeSyncStoreWithStorage(t,e){return this.size>0&&(e||t.type===s.d)}deserializeByProvider(e,n,r){const o=m(r),i=A(r,t.injector),s=i.getItem(o);return Object(a.d)(s)&&(e=this.deserializeHandler(e,{key:o,engine:i,provider:r,value:s,action:n})),e}deserializeHandler(e,n){const{key:r,provider:i,value:s}=n;try{const c=O(s),u=this.deserialize(c,s,i),l=function(t){const{data:e,provider:n}=t,r=Object(a.d)(e)||n.nullable;let o={canBeOverrideFromStorage:r,versionMismatch:!1,expired:!1,expiry:null};return o=function(t,e,n){const{meta:r,provider:o}=n;if(t&&y(o)){const n=new Date(r.expiry);!isNaN(n.getTime())&&(e=v(n)?{canBeOverrideFromStorage:!1,expired:!0,expiry:n,versionMismatch:!1}:{canBeOverrideFromStorage:t,expired:!1,expiry:n,versionMismatch:!1})}return e}(r,o,t),o=function(t,e,n){const{meta:r,provider:o}=n;if(t&&r.version!==o.version){const t=o.stateInstance,n=!(o.skipMigrate||!(null==t?void 0:t.ngxsDataStorageMigrate)&&!o.migrate);e=Object.assign(Object.assign({},e),n?{versionMismatch:!0}:{canBeOverrideFromStorage:!1,versionMismatch:!0})}return e}(r,o,t),o}({provider:i,meta:c,data:u});if(l.canBeOverrideFromStorage){const a=function(t){var e;let n=t.states;const{provider:r,data:a,info:i}=t;if(!r.rehydrate)return{states:n,rehydrateIn:!1};const s=Object(o.k)(n,r.path);if(i.versionMismatch){const t=r.stateInstance,i=r.migrate||(null===(e=t.ngxsDataStorageMigrate)||void 0===e?void 0:e.bind(r.stateInstance)),c=null==i?void 0:i(s,a);return n=Object(o.l)(n,r.path,c),{states:n,rehydrateIn:!0}}return JSON.stringify(s)!==JSON.stringify(a)?(n=Object(o.l)(n,r.path,a),{states:n,rehydrateIn:!0}):{states:n,rehydrateIn:!1}}({states:e,provider:i,data:u,info:l});this.keys.set(r),e=a.states,t.checkIsStorageEvent(n,a,u),t.checkExpiredInit({info:l,rehydrateInfo:a,options:n,map:this.ttlListeners})}else this.removeKeyWhenPullInvalid(l,n)}catch(c){!function(t,e,n){console.warn(`Error occurred while deserializing value from metadata { key: '${t}', value: '${e}' }. \nError deserialize: ${n}`)}(r,s,c.message)}return e}removeKeyWhenPullInvalid(t,e){const{key:n,engine:r,provider:o}=e;t.expired&&S(n,{provider:o,engine:r,map:this.ttlListeners,expiry:t.expiry}),r.removeItem(n),this.keys.delete(n)}listenWindowEvents(){Object(i.r)(this._platformId)||(this.destroyOldTasks(),t.eventsSubscriptions=Object(u.a)(window,"storage").subscribe(t=>{t.key&&this.keys.has(t.key)&&this.store.dispatch({type:s.d})}))}}return t.\u0275fac=function(e){return new(e||t)(r.Wb(r.D),r.Wb(r.t,2))},t.\u0275prov=r.Ib({token:t,factory:t.\u0275fac}),t.injector=null,t.eventsSubscriptions=null,t.ttlListeners=new WeakMap,t})();const _={provide:o.b,useClass:D,multi:!0},C=new r.s("NGXS_DATA_STORAGE_PREFIX_TOKEN");function R(t){var e;try{const n=null===(e=D.injector)||void 0===e?void 0:e.get(f);t.forEach(t=>{null==n||n.providers.add(t)})}catch(n){throw new Error("You forgot provide NGXS_DATA_STORAGE_CONTAINER or NGXS_DATA_STORAGE_EXTENSION!!! Example: \n\n@NgModule({\n imports: [ \n   NgxsDataPluginModule.forRoot([NGXS_DATA_STORAGE_PLUGIN]) \n ]\n})\nexport class AppModule {} \n\n")}}function P(t,e,n){var r,o,i,s;let c;const u=null!==(o=null===(r=D.injector)||void 0===r?void 0:r.get(C,"@ngxs.store."))&&void 0!==o?o:"@ngxs.store.",l=null!==(s=null===(i=D.injector)||void 0===i?void 0:i.get(h,"none"))&&void 0!==s?s:"none";return c=n?(Array.isArray(n)?n:[n]).map(n=>function({option:t,decodeType:e,prefix:n,meta:r,stateInstance:o}){return function(t,e){return"path"in e||(e=Object.assign(Object.assign({},e),{get path(){return t.stateMeta&&t.stateMeta.path}})),e}(r,Object.assign(Object.assign({},t),{ttl:Object(a.d)(t.ttl)?t.ttl:-1,version:Object(a.d)(t.version)?t.version:1,decode:Object(a.d)(t.decode)?t.decode:e,prefixKey:Object(a.d)(t.prefixKey)?t.prefixKey:n,nullable:!!Object(a.d)(t.nullable)&&t.nullable,fireInit:!Object(a.d)(t.fireInit)||t.fireInit,rehydrate:!Object(a.d)(t.rehydrate)||t.rehydrate,ttlDelay:Object(a.d)(t.ttlDelay)?t.ttlDelay:6e4,ttlExpiredStrategy:Object(a.d)(t.ttlExpiredStrategy)?t.ttlExpiredStrategy:0,stateInstance:Object(a.d)(t.stateInstance)?t.stateInstance:o,skipMigrate:!!Object(a.d)(t.skipMigrate)&&t.skipMigrate}))}({option:n,prefix:u,decodeType:l,meta:t,stateInstance:e})):function(t){const{meta:e,decodeType:n,prefix:r,stateInstance:o}=t;return[{get path(){return e.stateMeta&&e.stateMeta.path},existingEngine:localStorage,ttl:-1,version:1,decode:n,prefixKey:r,nullable:!1,fireInit:!0,rehydrate:!0,ttlDelay:6e4,ttlExpiredStrategy:0,stateInstance:o,skipMigrate:!1}]}({meta:t,prefix:u,decodeType:l,stateInstance:e}),c}},CIZ5:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return a}));const r="NGXS_DATA_STORAGE_EVENT_TYPE",o="NGXS_DATA_META",a="NGXS_META",i="NGXS_ARGUMENT_REGISTRY_META",s="NGXS_COMPUTED_OPTION"}},[[0,1,8]]]);